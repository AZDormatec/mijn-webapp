<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Dormatec</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="app-shell">
    <!-- Topbar -->
    <header class="topbar glass">
      <div class="brand">
        <img src="logo.png" alt="Dormatec" class="brand__logo" />
        <div class="brand__text">
          <div class="brand__title">Dormatec</div>
          <div class="brand__subtitle">Service Desk · Tickets · Agenda · Planning · Dashboard</div>
        </div>
      </div>

      <div class="topbar__right">
        <div class="pill">
          <span class="dot dot--ok"></span>
          <span id="whoami">Ingelogd: iedereen</span>
        </div>
        <button class="btn btn--ghost" id="btnExport">Export</button>
        <button class="btn btn--ghost" id="btnReset">Reset demo</button>
      </div>
    </header>

    <div class="layout">
      <!-- Sidebar -->
      <aside class="sidebar glass">
        <nav class="nav">
          <button class="nav__item is-active" data-view="dashboard">
            <span class="nav__icon"></span><span>Dashboard</span>
          </button>
          <button class="nav__item" data-view="tickets">
            <span class="nav__icon"></span><span>Tickets</span>
          </button>
          <button class="nav__item" data-view="agenda">
            <span class="nav__icon"></span><span>Agenda</span>
          </button>
          <button class="nav__item" data-view="planning">
            <span class="nav__icon"></span><span>Planning & Belasting</span>
          </button>
          <button class="nav__item" data-view="intake">
            <span class="nav__icon"></span><span>Intake (Sales → Binnendienst)</span>
          </button>
        </nav>

        <div class="sidebar__hint">
          <div class="hint__title">Tip</div>
          <div class="hint__text">
            Tickets in <b>Planning</b> met data/monteur worden automatisch zichtbaar in de <b>Agenda</b>.
            Klik agenda-items om te wijzigen.
          </div>
        </div>
      </aside>

      <!-- Main -->
      <main class="main">
        <!-- DASHBOARD -->
        <section class="view" id="view-dashboard">
          <div class="page-header glass">
            <div>
              <h1>Management Dashboard</h1>
              <p>Overzicht werkvoorraad, flow en belasting</p>
            </div>
            <div class="actions">
              <button class="btn btn--primary" id="btnNewTicketDash">+ Nieuw ticket</button>
            </div>
          </div>

          <div class="grid grid--3">
            <div class="card glass">
              <div class="card__title">Open tickets</div>
              <div class="kpi">
                <div class="kpi__value" id="kpiOpen">0</div>
                <div class="kpi__meta">Totaal niet-afgerond</div>
              </div>
            </div>

            <div class="card glass">
              <div class="card__title">In uitvoering</div>
              <div class="kpi">
                <div class="kpi__value" id="kpiDoing">0</div>
                <div class="kpi__meta">Status: In uitvoering</div>
              </div>
            </div>

            <div class="card glass">
              <div class="card__title">Deze week afronding</div>
              <div class="kpi">
                <div class="kpi__value" id="kpiClosing">0</div>
                <div class="kpi__meta">Status: Afronding (7 dagen)</div>
              </div>
            </div>
          </div>

          <div class="grid grid--2">
            <div class="card glass">
              <div class="card__title">Tickets per status</div>
              <div class="bars" id="statusBars"></div>
            </div>

            <div class="card glass">
              <div class="card__title">Belasting (uren) per medewerker</div>
              <div class="muted">Som van estimatedHours voor Planning + In uitvoering</div>
              <div class="bars" id="workloadBars"></div>
            </div>
          </div>
        </section>

        <!-- TICKETS -->
        <section class="view is-hidden" id="view-tickets">
          <div class="page-header glass">
            <div>
              <h1>Tickets</h1>
              <p>Kanban · filters · project-doorloop velden</p>
            </div>
            <div class="actions">
              <button class="btn btn--primary" id="btnNewTicket">+ Nieuw ticket</button>
              <button class="btn btn--ghost" id="btnSwitchView">Switch: Kanban</button>
            </div>
          </div>

          <div class="filters glass">
            <div class="field">
              <label>Zoeken</label>
              <input id="qSearch" type="text" placeholder="zoek op klant, order, titel, notitie..." />
            </div>
            <div class="field">
              <label>Assignee</label>
              <select id="qAssignee"></select>
            </div>
            <div class="field">
              <label>Prioriteit</label>
              <select id="qPriority">
                <option value="">Alles</option>
                <option value="Laag">Laag</option>
                <option value="Normaal">Normaal</option>
                <option value="Hoog">Hoog</option>
                <option value="Spoed">Spoed</option>
              </select>
            </div>
            <div class="field">
              <label>Type</label>
              <select id="qType">
                <option value="">Alles</option>
                <option value="Storing">Storing</option>
                <option value="Installatie">Installatie</option>
                <option value="Project">Project</option>
                <option value="Intern">Intern</option>
                <option value="Overig">Overig</option>
              </select>
            </div>
          </div>

          <div class="kanban-wrap glass">
            <div class="kanban" id="kanban"></div>
          </div>
        </section>

        <!-- AGENDA -->
        <section class="view is-hidden" id="view-agenda">
          <div class="page-header glass">
            <div>
              <h1>Agenda</h1>
              <p>Installaties + verlof · ticket-linked items komen uit Ticket Planning</p>
            </div>
            <div class="actions">
              <button class="btn btn--primary" id="btnAddAgenda">+ Toevoegen</button>
            </div>
          </div>

          <div class="grid grid--2">
            <div class="card glass">
              <div class="calendar-head">
                <button class="btn btn--ghost btn--icon" id="calPrev" aria-label="Vorige maand">‹</button>
                <div class="calendar-head__title" id="calTitle">—</div>
                <button class="btn btn--ghost btn--icon" id="calNext" aria-label="Volgende maand">›</button>
              </div>

              <div class="calendar">
                <div class="calendar__dow">
                  <div>Ma</div><div>Di</div><div>Wo</div><div>Do</div><div>Vr</div><div>Za</div><div>Zo</div>
                </div>
                <div class="calendar__grid" id="calGrid"></div>
              </div>
            </div>

            <div class="card glass">
              <div class="card__title">Legenda</div>
              <div class="legend">
                <div class="legend__row">
                  <span class="badge badge--install">Installatie</span>
                  <span class="muted">Werk gepland op klantlocatie</span>
                </div>
                <div class="legend__row">
                  <span class="badge badge--leave">Verlof</span>
                  <span class="muted">Afwezigheid zichtbaar voor iedereen</span>
                </div>
                <div class="legend__row">
                  <span class="badge badge--temp">Tijdelijk</span>
                  <span class="muted">Voorlopige planning</span>
                </div>
                <div class="legend__row">
                  <span class="badge badge--fixed">Definitief</span>
                  <span class="muted">Bevestigde planning</span>
                </div>
                <div class="legend__row">
                  <span class="badge badge--ticket">Ticket</span>
                  <span class="muted">Automatisch vanuit ticket in Planning</span>
                </div>
              </div>

              <div class="divider"></div>

              <div class="card__title">Items op geselecteerde dag</div>
              <div class="muted" id="dayHint">Klik in de kalender om items te zien.</div>
              <div class="daylist" id="dayList"></div>
            </div>
          </div>
        </section>

        <!-- PLANNING -->
        <section class="view is-hidden" id="view-planning">
          <div class="page-header glass">
            <div>
              <h1>Planning & Belasting</h1>
              <p>Belasting op basis van tickets + uren</p>
            </div>
            <div class="actions">
              <button class="btn btn--ghost" id="btnFocusPlanning">Toon tickets in Planning</button>
            </div>
          </div>

          <div class="grid grid--2">
            <div class="card glass">
              <div class="card__title">Belasting per medewerker</div>
              <div class="muted">Planning + In uitvoering (estimatedHours)</div>
              <div class="bars" id="workloadBars2"></div>
            </div>

            <div class="card glass">
              <div class="card__title">Planning queue</div>
              <div class="muted">Tickets in status: Planning</div>
              <div class="queue" id="planningQueue"></div>
            </div>
          </div>
        </section>

        <!-- INTAKE -->
        <section class="view is-hidden" id="view-intake">
          <div class="page-header glass">
            <div>
              <h1>Intake (Sales → Binnendienst)</h1>
              <p>Overdrachtsportal: maak een ticket met volledige projectinput</p>
            </div>
            <div class="actions">
              <button class="btn btn--primary" id="btnCreateFromIntake">Maak intake ticket</button>
            </div>
          </div>

          <div class="card glass">
            <div class="form-grid">
              <div class="field">
                <label>Klantnaam</label>
                <input id="inCustomer" type="text" placeholder="bijv. KLM" />
              </div>
              <div class="field">
                <label>Ordernummer</label>
                <input id="inOrder" type="text" placeholder="bijv. 12345" />
              </div>
              <div class="field">
                <label>Type</label>
                <select id="inType">
                  <option value="Installatie">Installatie</option>
                  <option value="Project">Project</option>
                  <option value="Storing">Storing</option>
                  <option value="Intern">Intern</option>
                  <option value="Overig">Overig</option>
                </select>
              </div>
              <div class="field">
                <label>Prioriteit</label>
                <select id="inPriority">
                  <option value="Normaal">Normaal</option>
                  <option value="Laag">Laag</option>
                  <option value="Hoog">Hoog</option>
                  <option value="Spoed">Spoed</option>
                </select>
              </div>

              <div class="field field--full">
                <label>Titel / onderwerp</label>
                <input id="inTitle" type="text" placeholder="Korte omschrijving van de opdracht" />
              </div>

              <div class="field field--full">
                <label>Sales notities / overdracht</label>
                <textarea id="inNotes" rows="7" placeholder="Belangrijke info, scope, contactpersonen, bijzonderheden..."></textarea>
              </div>

              <div class="field">
                <label>Gewenste startdatum</label>
                <input id="inStart" type="date" />
              </div>
              <div class="field">
                <label>Gewenste einddatum</label>
                <input id="inEnd" type="date" />
              </div>
            </div>
          </div>
        </section>
      </main>
    </div>

    <!-- Modal root -->
    <div class="overlay is-hidden" id="overlay"></div>
    <div class="modal is-hidden" id="modal">
      <div class="modal__card glass">
        <div class="modal__head">
          <div>
            <div class="modal__title" id="modalTitle">—</div>
            <div class="modal__subtitle" id="modalSubtitle">—</div>
          </div>
          <button class="btn btn--ghost btn--icon" id="modalClose" aria-label="Sluiten">✕</button>
        </div>
        <div class="modal__body" id="modalBody"></div>
        <div class="modal__foot" id="modalFoot"></div>
      </div>
    </div>

    <div class="toast-wrap" id="toastWrap"></div>
  </div>

  <script src="app.js"></script>
</body>
</html>
